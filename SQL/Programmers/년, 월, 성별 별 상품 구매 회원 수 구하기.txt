-- https://school.programmers.co.kr/learn/courses/30/lessons/131532
SELECT TO_CHAR(OS.SALES_DATE, 'YYYY') AS "YEAR"
     , TO_NUMBER(TO_CHAR(OS.SALES_DATE, 'MM')) AS "MONTH"
     , UI.GENDER AS "GENDER"
     , COUNT(DISTINCT UI.USER_ID) AS "USERS"
  FROM ONLINE_SALE OS
     , (SELECT USER_ID, GENDER
          FROM USER_INFO
         WHERE GENDER IS NOT NULL) UI
 WHERE OS.USER_ID = UI.USER_ID
 GROUP BY TO_CHAR(OS.SALES_DATE, 'YYYY'), TO_NUMBER(TO_CHAR(OS.SALES_DATE, 'MM')), GENDER
 ORDER BY TO_CHAR(OS.SALES_DATE, 'YYYY') ASC, TO_NUMBER(TO_CHAR(OS.SALES_DATE, 'MM')) ASC, GENDER ASC